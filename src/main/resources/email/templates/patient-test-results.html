<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Resultados del Test</title>
</head>

<body style="font-family: sans-serif">

<h1 style="text-align: center">Resultados del Test</h1>

<div style="margin-left: 10%; margin-top: 5%;">

    <h3 th:text="|Paciente: ${testResult.patientFirstName} ${testResult.patientLastName}|"></h3>

    <h3 th:text="|Fecha: ${testResult.testPlayedDate}|"></h3>

    <h3 th:text="|Puntuación Total: ${testResult.score}/35|"></h3>

    <h3 th:text="|Nivel de demencia: ${testResult.dementiaLevel.displayName}|"></h3><br/>

    <h3>Resultados por categoría (cada respuesta equivale a 1 punto):</h3>

    <ul>
        <li style="margin-top: 50px" th:each="gameResult: ${testResult.gameResults}">

            <h4 th:text="${gameResult.category.displayName}"></h4>

            <p><strong>Puntuación máxima: </strong><span th:text="${gameResult.category.maxTestScore}"></span></p>

            <div th:each="task: ${gameResult.taskResults}">

                <p><strong>Consigna: </strong><span th:text="${task.description}"></span></p>

                <div th:if="${#lists.size(task.expectedAnswers) > 0}">
                    <b><p>Respuesta/s esperada/s:</p></b>
                    <div th:each="expectedAnswer: ${task.expectedAnswers}">
                        <div th:if="${expectedAnswer.type.name() == 'TEXT'}">
                            <p th:text="${expectedAnswer.value}"></p>
                        </div>
                        <div th:if="${expectedAnswer.type.name() == 'IMAGE'}">
                            <img th:src="|data:image/png;base64,${expectedAnswer.value}|"/>
                        </div>
                        <br/>
                    </div>
                </div>

                <b><p>Respuesta/s del paciente:</p></b>
                <div th:each="patientAnswer: ${task.patientAnswers}">
                    <div th:if="${patientAnswer.type.name() == 'TEXT'}">
                        <p th:text="${patientAnswer.value}"></p>
                    </div>
                    <div th:if="${patientAnswer.type.name() == 'IMAGE'}">
                        <img th:src="|data:image/png;base64,${patientAnswer.value}|"/>
                    </div>
                    <br/>
                </div>

                <p><strong>Puntuación obtenida: </strong><span th:text="${task.score}"></span></p>
            </div>

        </li>
    </ul>

    <div id="table_div" style="margin-right: 10%"></div>

</div>

</body>

</html>
